<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Website Organisasi</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    .hero {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 80px 0;
    }

    .card-hover:hover {
      transform: translateY(-5px);
      transition: 0.3s;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .member-card img {
      width: 100%;
      height: 250px;
      object-fit: cover;
    }

    .post-img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .gallery-item img {
      width: 100%;
      height: 200px;
      object-fit: cover;
      cursor: pointer;
    }

    .loading {
      text-align: center;
      padding: 40px;
    }

    .navbar-brand {
      font-weight: bold;
      font-size: 1.5rem;
    }

    footer {
      background: #333;
      color: white;
      padding: 40px 0;
      margin-top: 60px;
    }
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container">
      <a class="navbar-brand" href="#" id="siteName">CMS Organisasi</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('home')">Beranda</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('about')">Tentang</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('structure')">Struktur</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('posts')">Berita</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('gallery')">Galeri</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('documents')">Dokumen</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('contact')">Kontak</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div id="mainContent"></div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-3">
          <h5 id="footerSiteName">Website Organisasi</h5>
          <p id="footerDescription">Deskripsi organisasi akan muncul di sini.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h5>Kontak</h5>
          <p id="footerContact">
            <i class="bi bi-envelope"></i> <span id="footerEmail">-</span><br>
            <i class="bi bi-telephone"></i> <span id="footerPhone">-</span><br>
            <i class="bi bi-geo-alt"></i> <span id="footerAddress">-</span>
          </p>
        </div>
        <div class="col-md-4 mb-3">
          <h5>Media Sosial</h5>
          <div id="footerSocial"></div>
        </div>
      </div>
      <hr class="bg-light">
      <div class="text-center">
        <p>&copy; 2024 <span id="footerCopyright">Website Organisasi</span>. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const API_URL = 'http://localhost:3000';
    let currentSettings = {};
    let currentAbout = {};

    // Initialize
    async function init() {
      await loadSettings();
      await loadAbout();
      showPage('home');
    }

    // Load Settings
    async function loadSettings() {
      try {
        const response = await fetch(`${API_URL}/api/public/settings`);
        currentSettings = await response.json();

        document.getElementById('siteName').textContent = currentSettings.siteName || 'Website Organisasi';
        document.getElementById('footerSiteName').textContent = currentSettings.siteName || 'Website Organisasi';
        document.getElementById('footerCopyright').textContent = currentSettings.siteName || 'Website Organisasi';
        document.getElementById('footerDescription').textContent = currentSettings.description || '';

        if (currentSettings.contactInfo) {
          document.getElementById('footerEmail').textContent = currentSettings.contactInfo.email || '-';
          document.getElementById('footerPhone').textContent = currentSettings.contactInfo.phone || '-';
          document.getElementById('footerAddress').textContent = currentSettings.contactInfo.address || '-';
        }

        if (currentSettings.socialMedia) {
          let socialHTML = '';
          const socials = currentSettings.socialMedia;
          if (socials.facebook) socialHTML += `<a href="${socials.facebook}" class="text-white me-3"><i class="bi bi-facebook fs-4"></i></a>`;
          if (socials.instagram) socialHTML += `<a href="${socials.instagram}" class="text-white me-3"><i class="bi bi-instagram fs-4"></i></a>`;
          if (socials.twitter) socialHTML += `<a href="${socials.twitter}" class="text-white me-3"><i class="bi bi-twitter fs-4"></i></a>`;
          if (socials.youtube) socialHTML += `<a href="${socials.youtube}" class="text-white me-3"><i class="bi bi-youtube fs-4"></i></a>`;
          document.getElementById('footerSocial').innerHTML = socialHTML;
        }
      } catch (error) {
        console.error('Error loading settings:', error);
      }
    }

    // Load About
    async function loadAbout() {
      try {
        const response = await fetch(`${API_URL}/api/public/about`);
        currentAbout = await response.json();
      } catch (error) {
        console.error('Error loading about:', error);
      }
    }

    // Show Page
    function showPage(page) {
      const content = document.getElementById('mainContent');
      content.innerHTML = '<div class="loading"><div class="spinner-border text-primary"></div></div>';

      switch (page) {
        case 'home':
          loadHomePage();
          break;
        case 'about':
          loadAboutPage();
          break;
        case 'structure':
          loadStructurePage();
          break;
        case 'posts':
          loadPostsPage();
          break;
        case 'gallery':
          loadGalleryPage();
          break;
        case 'documents':
          loadDocumentsPage();
          break;
        case 'contact':
          loadContactPage();
          break;
      }
    }

    // Home Page
    async function loadHomePage() {
      try {
        const [stats, posts] = await Promise.all([
          fetch(`${API_URL}/api/public/stats`).then(r => r.json()),
          fetch(`${API_URL}/api/public/posts/latest?limit=6`).then(r => r.json())
        ]);

        const content = `
                    <div class="hero">
                        <div class="container text-center">
                            <h1 class="display-4 mb-3">${currentSettings.siteName || 'Website Organisasi'}</h1>
                            <p class="lead">${currentSettings.tagline || 'Selamat datang di website kami'}</p>
                        </div>
                    </div>

                    <div class="container mt-5">
                        <div class="row text-center mb-5">
                            <div class="col-md-3 mb-3">
                                <div class="card card-hover">
                                    <div class="card-body">
                                        <i class="bi bi-people fs-1 text-primary"></i>
                                        <h3 class="mt-3">${stats.totalMembers || 0}</h3>
                                        <p class="text-muted">Anggota Aktif</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card card-hover">
                                    <div class="card-body">
                                        <i class="bi bi-newspaper fs-1 text-success"></i>
                                        <h3 class="mt-3">${stats.totalPosts || 0}</h3>
                                        <p class="text-muted">Berita & Artikel</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card card-hover">
                                    <div class="card-body">
                                        <i class="bi bi-images fs-1 text-warning"></i>
                                        <h3 class="mt-3">${stats.totalGalleries || 0}</h3>
                                        <p class="text-muted">Galeri Foto</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card card-hover">
                                    <div class="card-body">
                                        <i class="bi bi-file-earmark-text fs-1 text-danger"></i>
                                        <h3 class="mt-3">${stats.totalDocuments || 0}</h3>
                                        <p class="text-muted">Dokumen</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h2 class="mb-4">Berita Terbaru</h2>
                        <div class="row">
                            ${posts.docs.map(post => `
                                <div class="col-md-4 mb-4">
                                    <div class="card card-hover h-100">
                                        <img src="${getImageUrl(post.featuredImage?.url)}" class="card-img-top post-img" alt="${post.title}">
                                        <div class="card-body">
                                            <span class="badge bg-primary mb-2">${getCategoryLabel(post.category)}</span>
                                            <h5 class="card-title">${post.title}</h5>
                                            <p class="card-text text-muted small">${post.excerpt}</p>
                                            <p class="text-muted small">
                                                <i class="bi bi-calendar"></i> ${formatDate(post.publishedDate)}
                                                <i class="bi bi-eye ms-2"></i> ${post.views || 0}
                                            </p>
                                            <button class="btn btn-outline-primary btn-sm" onclick="showPostDetail('${post.slug}')">Baca Selengkapnya</button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="text-center mt-4">
                            <button class="btn btn-primary" onclick="showPage('posts')">Lihat Semua Berita</button>
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // About Page
    async function loadAboutPage() {
      const content = `
                <div class="container mt-5">
                    <h1 class="mb-4">${currentAbout.title || 'Tentang Kami'}</h1>
                    
                    <div class="card mb-4">
                        <div class="card-body">
                            <h3>Sejarah</h3>
                            <div>${currentAbout.history || 'Belum ada sejarah organisasi.'}</div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h3>Visi</h3>
                                    <p>${currentAbout.vision || 'Belum ada visi.'}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h3>Misi</h3>
                                    <p>${currentAbout.mission || 'Belum ada misi.'}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    ${currentAbout.values && currentAbout.values.length > 0 ? `
                        <div class="card mb-4">
                            <div class="card-body">
                                <h3>Nilai-Nilai</h3>
                                <div class="row">
                                    ${currentAbout.values.map(v => `
                                        <div class="col-md-4 mb-3">
                                            <h5>${v.value}</h5>
                                            <p class="text-muted">${v.description}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    ` : ''}

                    ${currentAbout.achievements && currentAbout.achievements.length > 0 ? `
                        <div class="card">
                            <div class="card-body">
                                <h3>Prestasi</h3>
                                ${currentAbout.achievements.map(a => `
                                    <div class="mb-3">
                                        <h5>${a.year} - ${a.title}</h5>
                                        <p class="text-muted">${a.description}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;

      document.getElementById('mainContent').innerHTML = content;
    }

    // Structure Page
    async function loadStructurePage() {
      try {
        const [period, structure] = await Promise.all([
          fetch(`${API_URL}/api/public/period/active`).then(r => r.json()),
          fetch(`${API_URL}/api/public/structure`).then(r => r.json())
        ]);

        const content = `
                    <div class="container mt-5">
                        <h1 class="mb-4">Struktur Organisasi</h1>
                        <div class="alert alert-info">
                            <strong>Periode Aktif:</strong> ${period.name} (${formatDate(period.startDate)} - ${formatDate(period.endDate)})
                        </div>

                        ${structure.structure.map(pos => `
                            ${pos.members.length > 0 ? `
                                <div class="mb-5">
                                    <h3 class="mb-3">${pos.title}${pos.department ? ` - ${pos.department}` : ''}</h3>
                                    <div class="row">
                                        ${pos.members.map(member => `
                                            <div class="col-md-3 mb-4">
                                                <div class="card card-hover member-card">
                                                    <img src="${getImageUrl(member.photo?.url || '')}" class="card-img-top" alt="${member.name}">
                                                    <div class="card-body text-center">
                                                        <h5 class="card-title">${member.name}</h5>
                                                        <p class="text-muted small">${pos.title}</p>
                                                        ${member.email ? `<p class="small"><i class="bi bi-envelope"></i> ${member.email}</p>` : ''}
                                                        ${member.phone ? `<p class="small"><i class="bi bi-phone"></i> ${member.phone}</p>` : ''}
                                                        <button class="btn btn-sm btn-outline-primary" onclick="showMemberDetail('${member.slug}')">Detail</button>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        `).join('')}
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Posts Page
    async function loadPostsPage(category = '') {
      try {
        const url = category ? `${API_URL}/api/public/posts?category=${category}&limit=12` : `${API_URL}/api/public/posts?limit=12`;
        const posts = await fetch(url).then(r => r.json());

        const content = `
                    <div class="container mt-5">
                        <h1 class="mb-4">Berita & Kegiatan</h1>
                        
                        <div class="mb-4">
                            <button class="btn ${!category ? 'btn-primary' : 'btn-outline-primary'} me-2" onclick="loadPostsPage('')">Semua</button>
                            <button class="btn ${category === 'news' ? 'btn-primary' : 'btn-outline-primary'} me-2" onclick="loadPostsPage('news')">Berita</button>
                            <button class="btn ${category === 'activity' ? 'btn-primary' : 'btn-outline-primary'} me-2" onclick="loadPostsPage('activity')">Kegiatan</button>
                            <button class="btn ${category === 'announcement' ? 'btn-primary' : 'btn-outline-primary'} me-2" onclick="loadPostsPage('announcement')">Pengumuman</button>
                            <button class="btn ${category === 'achievement' ? 'btn-primary' : 'btn-outline-primary'}" onclick="loadPostsPage('achievement')">Prestasi</button>
                        </div>

                        <div class="row">
                            ${posts.docs.map(post => `
                                <div class="col-md-4 mb-4">
                                    <div class="card card-hover h-100">
                                        <img src="${getImageUrl(post.featuredImage?.url || '')}" class="card-img-top post-img" alt="${post.title}">
                                        <div class="card-body">
                                            <span class="badge bg-primary mb-2">${getCategoryLabel(post.category)}</span>
                                            <h5 class="card-title">${post.title}</h5>
                                            <p class="card-text text-muted small">${post.excerpt}</p>
                                            <p class="text-muted small">
                                                <i class="bi bi-calendar"></i> ${formatDate(post.publishedDate)}
                                                <i class="bi bi-eye ms-2"></i> ${post.views || 0}
                                            </p>
                                            <button class="btn btn-outline-primary btn-sm" onclick="showPostDetail('${post.slug}')">Baca Selengkapnya</button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Post Detail
    async function showPostDetail(slug) {
      try {
        const post = await fetch(`${API_URL}/api/public/posts/${slug}`).then(r => r.json());

        const content = `
                    <div class="container mt-5">
                        <button class="btn btn-outline-secondary mb-3" onclick="showPage('posts')">
                            <i class="bi bi-arrow-left"></i> Kembali
                        </button>
                        
                        <div class="card">
                            <img src="${getImageUrl(post.featuredImage?.url || '')}" class="card-img-top post-img" alt="${post.title}">
                            <div class="card-body">
                                <span class="badge bg-primary mb-2">${getCategoryLabel(post.category)}</span>
                                <h1 class="card-title">${post.title}</h1>
                                <p class="text-muted">
                                    <i class="bi bi-calendar"></i> ${formatDate(post.publishedDate)}
                                    <i class="bi bi-person ms-3"></i> ${post.author?.name || 'Admin'}
                                    <i class="bi bi-eye ms-3"></i> ${post.views || 0} views
                                </p>
                                <hr>
                                <div class="post-content">${post.content}</div>
                                
                                ${post.gallery && post.gallery.length > 0 ? `
                                    <hr>
                                    <h4>Galeri</h4>
                                    <div class="row">
                                        ${post.gallery.map(item => `
                                            <div class="col-md-4 mb-3">
                                                <img src="${getImageUrl(post.featuredImage?.url || '')}" class="card-img-top post-img" alt="${post.title}">
                                                ${item.caption ? `<p class="text-muted small mt-2">${item.caption}</p>` : ''}
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Gallery Page
    async function loadGalleryPage() {
      try {
        const galleries = await fetch(`${API_URL}/api/public/galleries`).then(r => r.json());

        const content = `
                    <div class="container mt-5">
                        <h1 class="mb-4">Galeri</h1>
                        
                        <div class="row">
                            ${galleries.docs.map(gallery => `
                                <div class="col-md-4 mb-4">
                                    <div class="card card-hover">
                                        <img src="${getImageUrl(gallery.coverImage?.url || gallery.items?.[0]?.media?.url || '')}" class="card-img-top gallery-item" alt="${gallery.title}" onclick="showGalleryDetail('${gallery.slug}')">
                                        <div class="card-body">
                                            <h5 class="card-title">${gallery.title}</h5>
                                            <p class="text-muted small">${gallery.description || ''}</p>
                                            <p class="text-muted small">
                                                <i class="bi bi-calendar"></i> ${formatDate(gallery.eventDate)}
                                                <span class="badge bg-secondary ms-2">${gallery.items?.length || 0} foto</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Gallery Detail
    async function showGalleryDetail(slug) {
      try {
        const gallery = await fetch(`${API_URL}/api/public/galleries/${slug}`).then(r => r.json());

        const content = `
                    <div class="container mt-5">
                        <button class="btn btn-outline-secondary mb-3" onclick="showPage('gallery')">
                            <i class="bi bi-arrow-left"></i> Kembali
                        </button>
                        
                        <h1 class="mb-2">${gallery.title}</h1>
                        <p class="text-muted mb-4">
                            <i class="bi bi-calendar"></i> ${formatDate(gallery.eventDate)}
                        </p>
                        <p>${gallery.description || ''}</p>
                        
                        <div class="row">
                            ${gallery.items.map(item => `
                                <div class="col-md-4 mb-4">
                                   <div class="card">
                                        <img src="${getImageUrl(item.media?.url || '')}" class="card-img-top gallery-item" alt="${item.caption || ''}">
                                        ${item.caption ? `
                                            <div class="card-body">
                                                <p class="card-text small">${item.caption}</p>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Documents Page
    async function loadDocumentsPage() {
      try {
        const documents = await fetch(`${API_URL}/api/public/documents`).then(r => r.json());

        const content = `
                    <div class="container mt-5">
                        <h1 class="mb-4">Dokumen & Arsip</h1>
                        
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Judul</th>
                                        <th>Kategori</th>
                                        <th>Tanggal Upload</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${documents.docs.map(doc => `
                                        <tr>
                                            <td>${doc.title}</td>
                                            <td><span class="badge bg-info">${getDocCategoryLabel(doc.category)}</span></td>
                                            <td>${formatDate(doc.uploadDate)}</td>
                                            <td>
                                                <a href="${API_URL}${doc.file?.url || ''}" class="btn btn-sm btn-primary" target="_blank">
                                                    <i class="bi bi-download"></i> Download
                                                </a>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Member Detail
    async function showMemberDetail(slug) {
      try {
        const member = await fetch(`${API_URL}/api/public/members/${slug}`).then(r => r.json());

        const content = `
                    <div class="container mt-5">
                        <button class="btn btn-outline-secondary mb-3" onclick="showPage('structure')">
                            <i class="bi bi-arrow-left"></i> Kembali
                        </button>
                        
                        <div class="row">
                            <div class="col-md-4 mb-4">
                               <img src="${getImageUrl(member.photo?.url || '')}" class="card-img-top" alt="${member.name}">
                            </div>
                            <div class="col-md-8">
                                <h1>${member.name}</h1>
                                <p class="lead text-muted">${member.position?.title || ''}</p>
                                
                                ${member.email ? `<p><i class="bi bi-envelope"></i> ${member.email}</p>` : ''}
                                ${member.phone ? `<p><i class="bi bi-phone"></i> ${member.phone}</p>` : ''}
                                
                                ${member.bio ? `
                                    <hr>
                                    <h4>Biografi</h4>
                                    <div>${member.bio}</div>
                                ` : ''}
                                
                                ${member.socialMedia ? `
                                    <hr>
                                    <h4>Media Sosial</h4>
                                    ${member.socialMedia.facebook ? `<a href="${member.socialMedia.facebook}" class="btn btn-outline-primary me-2" target="_blank"><i class="bi bi-facebook"></i></a>` : ''}
                                    ${member.socialMedia.instagram ? `<a href="${member.socialMedia.instagram}" class="btn btn-outline-primary me-2" target="_blank"><i class="bi bi-instagram"></i></a>` : ''}
                                    ${member.socialMedia.twitter ? `<a href="${member.socialMedia.twitter}" class="btn btn-outline-primary me-2" target="_blank"><i class="bi bi-twitter"></i></a>` : ''}
                                    ${member.socialMedia.linkedin ? `<a href="${member.socialMedia.linkedin}" class="btn btn-outline-primary me-2" target="_blank"><i class="bi bi-linkedin"></i></a>` : ''}
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;

        document.getElementById('mainContent').innerHTML = content;
      } catch (error) {
        document.getElementById('mainContent').innerHTML = `
                    <div class="container mt-5">
                        <div class="alert alert-danger">Error: ${error.message}</div>
                    </div>
                `;
      }
    }

    // Contact Page
    async function loadContactPage() {
      const content = `
                <div class="container mt-5">
                    <h1 class="mb-4">Hubungi Kami</h1>
                    
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-body">
                                    <h4>Informasi Kontak</h4>
                                    <hr>
                                    <p><i class="bi bi-envelope fs-5"></i> <strong>Email:</strong><br>${currentSettings.contactInfo?.email || '-'}</p>
                                    <p><i class="bi bi-phone fs-5"></i> <strong>Telepon:</strong><br>${currentSettings.contactInfo?.phone || '-'}</p>
                                    <p><i class="bi bi-geo-alt fs-5"></i> <strong>Alamat:</strong><br>${currentSettings.contactInfo?.address || '-'}</p>
                                    
                                    ${currentSettings.socialMedia ? `
                                        <hr>
                                        <h5>Ikuti Kami</h5>
                                        ${currentSettings.socialMedia.facebook ? `<a href="${currentSettings.socialMedia.facebook}" class="btn btn-outline-primary me-2 mb-2" target="_blank"><i class="bi bi-facebook"></i> Facebook</a>` : ''}
                                        ${currentSettings.socialMedia.instagram ? `<a href="${currentSettings.socialMedia.instagram}" class="btn btn-outline-primary me-2 mb-2" target="_blank"><i class="bi bi-instagram"></i> Instagram</a>` : ''}
                                        ${currentSettings.socialMedia.twitter ? `<a href="${currentSettings.socialMedia.twitter}" class="btn btn-outline-primary me-2 mb-2" target="_blank"><i class="bi bi-twitter"></i> Twitter</a>` : ''}
                                        ${currentSettings.socialMedia.youtube ? `<a href="${currentSettings.socialMedia.youtube}" class="btn btn-outline-primary me-2 mb-2" target="_blank"><i class="bi bi-youtube"></i> YouTube</a>` : ''}
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-body">
                                    <h4>Kirim Pesan</h4>
                                    <hr>
                                    <form id="contactForm" onsubmit="submitContactForm(event)">
                                        <div class="mb-3">
                                            <label class="form-label">Nama</label>
                                            <input type="text" class="form-control" name="name" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Email</label>
                                            <input type="email" class="form-control" name="email" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Subjek</label>
                                            <input type="text" class="form-control" name="subject" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Pesan</label>
                                            <textarea class="form-control" name="message" rows="5" required></textarea>
                                        </div>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="bi bi-send"></i> Kirim Pesan
                                        </button>
                                    </form>
                                    <div id="contactAlert" class="mt-3"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    ${currentSettings.contactInfo?.mapUrl ? `
                        <div class="card mt-4">
                            <div class="card-body">
                                <h4>Lokasi Kami</h4>
                                <hr>
                                <iframe src="${currentSettings.contactInfo.mapUrl}" width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;

      document.getElementById('mainContent').innerHTML = content;
    }

    // Submit Contact Form
    async function submitContactForm(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);

      try {
        const response = await fetch(`${API_URL}/api/public/contact`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });

        const result = await response.json();

        document.getElementById('contactAlert').innerHTML = `
                    <div class="alert alert-success">
                        <i class="bi bi-check-circle"></i> ${result.message}
                    </div>
                `;

        form.reset();
      } catch (error) {
        document.getElementById('contactAlert').innerHTML = `
                    <div class="alert alert-danger">
                        <i class="bi bi-x-circle"></i> Terjadi kesalahan. Silakan coba lagi.
                    </div>
                `;
      }
    }

    // Helper Functions
    function getImageUrl(url) {
      if (!url) return '';
      // Jika URL sudah lengkap (http/https), return as is
      if (url.startsWith('http://') || url.startsWith('https://')) {
        return url;
      }
      // Jika URL relatif, tambahkan API_URL
      return `${API_URL}${url}`;
    }

    function formatDate(dateString) {
      if (!dateString) return '-';
      const date = new Date(dateString);
      const options = {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      };
      return date.toLocaleDateString('id-ID', options);
    }

    function getCategoryLabel(category) {
      const labels = {
        'news': 'Berita',
        'activity': 'Kegiatan',
        'announcement': 'Pengumuman',
        'achievement': 'Prestasi'
      };
      return labels[category] || category;
    }

    function getDocCategoryLabel(category) {
      const labels = {
        'sk': 'Surat Keputusan',
        'se': 'Surat Edaran',
        'report': 'Laporan',
        'proposal': 'Proposal',
        'ad_art': 'AD/ART',
        'other': 'Lainnya'
      };
      return labels[category] || category;
    }

    // Initialize on page load
    init();
  </script>
</body>

</html>